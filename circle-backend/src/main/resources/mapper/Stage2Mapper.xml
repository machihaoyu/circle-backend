<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.fjs.circle.mappers.Stage2Mapper">
    <resultMap id="yearServiceResultMap" type="com.fjs.circle.dto.stage2.YearServiceDTO">
        <id column="rownum" property="rownum" jdbcType="INTEGER" />
        <result column="sub_company_name" property="subCompanyName" jdbcType="VARCHAR" />
        <result column="service_contract_num" property="serviceContractNum" jdbcType="INTEGER" />
    </resultMap>

    <select id="getYearService" resultMap="yearServiceResultMap" parameterType="java.util.Map" >
        select  rownum                  -- 年度排名
       ,sub_company_name        -- 分公司
       ,service_contract_num    -- 签订协议数
      from fangdb.dapp_sub_company_top
      where busi_type=1
    </select>

    <resultMap id="yearContractResultMap" type="com.fjs.circle.dto.stage2.YearContractDTO">
        <id column="rownum" property="rownum" jdbcType="INTEGER" />
        <result column="sub_company_name" property="subCompanyName" jdbcType="VARCHAR" />
        <result column="give_money" property="giveMoney" jdbcType="VARCHAR" />
    </resultMap>

    <select id="getYearContract" resultMap="yearContractResultMap" parameterType="java.util.Map" >
        select  rownum                  -- 年度排名
       ,sub_company_name        -- 分公司
       ,give_money              -- 放款额
        from fangdb.dapp_sub_company_top
        where busi_type=2
    </select>

    <resultMap id="yearCommissionResultMap" type="com.fjs.circle.dto.stage2.YearCommissionDTO">
        <id column="rownum" property="rownum" jdbcType="INTEGER" />
        <result column="sub_company_name" property="subCompanyName" jdbcType="VARCHAR" />
        <result column="commission_total" property="commissionTotal" jdbcType="VARCHAR" />
    </resultMap>

    <select id="getYearCommission" resultMap="yearCommissionResultMap" parameterType="java.util.Map" >
        select rownum                   -- 年度排名
		,sub_company_name           -- 分公司
		,commission_total		        -- 收佣额
        from fangdb.dapp_sub_company_top
        where busi_type=3
    </select>

    <select id="getSeasonService" resultMap="yearServiceResultMap" parameterType="java.util.Map" >
        select rownum                   -- 季度排名
		,sub_company_name		        -- 分公司
		,service_contract_num	      -- 签订协议数
        from fangdb.dapp_sub_company_top
        where busi_type=4
    </select>

    <select id="getSeasonContract" resultMap="yearContractResultMap" parameterType="java.util.Map" >
        select  rownum                  -- 年度排名
        ,sub_company_name        -- 分公司
        ,give_money              -- 放款额
        from fangdb.dapp_sub_company_top
        where busi_type=5
    </select>

    <select id="getSeasonCommission" resultMap="yearCommissionResultMap" parameterType="java.util.Map" >
        select rownum                   -- 年度排名
        ,sub_company_name           -- 分公司
        ,commission_total		        -- 收佣额
        from fangdb.dapp_sub_company_top
        where busi_type=6
    </select>

    <select id="getMonthService" resultMap="yearServiceResultMap" parameterType="java.util.Map" >
        select rownum                   -- 季度排名
        ,sub_company_name		        -- 分公司
        ,service_contract_num	      -- 签订协议数
        from fangdb.dapp_sub_company_top
        where busi_type=7
    </select>

    <select id="getMonthContract" resultMap="yearContractResultMap" parameterType="java.util.Map" >
        select  rownum                  -- 年度排名
        ,sub_company_name        -- 分公司
        ,give_money              -- 放款额
        from fangdb.dapp_sub_company_top
        where busi_type=8
    </select>

    <select id="getMonthCommission" resultMap="yearCommissionResultMap" parameterType="java.util.Map" >
        select rownum                   -- 年度排名
        ,sub_company_name           -- 分公司
        ,commission_total		        -- 收佣额
        from fangdb.dapp_sub_company_top
        where busi_type=9
    </select>
</mapper>